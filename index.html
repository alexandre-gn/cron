<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Convertisseur Temps vers CRON (avec secondes)</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        .gradient-bg {
            background: linear-gradient(135deg, #6b21a8 0%, #1e40af 100%);
        }
        .input-focus:focus {
            box-shadow: 0 0 0 3px rgba(99, 102, 241, 0.3);
        }
        .result-box {
            transition: all 0.3s ease;
        }
        .copy-btn {
            transition: all 0.2s ease;
        }
        .copy-btn:hover {
            transform: scale(1.05);
        }
        .copy-btn:active {
            transform: scale(0.95);
        }
        .tooltip {
            position: relative;
        }
        .tooltip-text {
            visibility: hidden;
            width: 120px;
            background-color: #4b5563;
            color: #fff;
            text-align: center;
            border-radius: 6px;
            padding: 5px;
            position: absolute;
            z-index: 1;
            bottom: 125%;
            left: 50%;
            margin-left: -60px;
            opacity: 0;
            transition: opacity 0.3s;
        }
        .tooltip:hover .tooltip-text {
            visibility: visible;
            opacity: 1;
        }
        .time-inputs {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 0.5rem;
        }
        .time-input {
            display: flex;
            flex-direction: column;
        }
    </style>
</head>
<body class="min-h-screen bg-gray-100">
    <div class="gradient-bg text-white py-12 px-4">
        <div class="max-w-4xl mx-auto text-center">
            <h1 class="text-4xl font-bold mb-4">Convertisseur Temps vers CRON</h1>
            <p class="text-xl opacity-90">Transformez facilement vos dates et heures en expressions CRON (avec secondes)</p>
        </div>
    </div>

    <div class="max-w-4xl mx-auto px-4 py-8 -mt-12">
        <div class="bg-white rounded-xl shadow-lg overflow-hidden">
            <div class="p-6 md:p-8">
                <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                    <div>
                        <div class="flex justify-between items-center mb-6">
                            <h2 class="text-2xl font-semibold text-gray-800">Paramètres</h2>
                            <button id="reset-btn" class="text-indigo-600 hover:text-indigo-800 flex items-center gap-1">
                                <i class="fas fa-redo"></i>
                                <span>Réinitialiser</span>
                            </button>
                        </div>
                        
                        <div class="space-y-6">
                            <div>
                                <label class="block text-gray-700 font-medium mb-2" for="date">Date</label>
                                <input type="date" id="date" class="w-full px-4 py-2 border border-gray-300 rounded-lg input-focus focus:outline-none focus:border-indigo-500">
                            </div>
                            
                            <div>
                                <label class="block text-gray-700 font-medium mb-2">Heure (HH:MM:SS)</label>
                                <div class="time-inputs">
                                    <div class="time-input">
                                        <label class="text-sm text-gray-500 mb-1">Heures</label>
                                        <input type="number" id="hours" min="0" max="23" value="0" class="px-3 py-2 border border-gray-300 rounded-lg input-focus">
                                    </div>
                                    <div class="time-input">
                                        <label class="text-sm text-gray-500 mb-1">Minutes</label>
                                        <input type="number" id="minutes" min="0" max="59" value="0" class="px-3 py-2 border border-gray-300 rounded-lg input-focus">
                                    </div>
                                    <div class="time-input">
                                        <label class="text-sm text-gray-500 mb-1">Secondes</label>
                                        <input type="number" id="seconds" min="0" max="59" value="0" class="px-3 py-2 border border-gray-300 rounded-lg input-focus">
                                    </div>
                                    <div class="time-input flex items-end">
                                        <button id="now-btn" class="bg-gray-200 hover:bg-gray-300 text-gray-800 px-3 py-2 rounded-lg text-sm">
                                            Maintenant
                                        </button>
                                    </div>
                                </div>
                            </div>
                            
                            <div>
                                <label class="block text-gray-700 font-medium mb-2">Fréquence</label>
                                <div class="grid grid-cols-2 gap-4">
                                    <button id="once" class="frequency-btn bg-indigo-600 text-white px-4 py-2 rounded-lg font-medium">Une fois</button>
                                    <button id="daily" class="frequency-btn bg-white border border-gray-300 px-4 py-2 rounded-lg font-medium">Quotidien</button>
                                    <button id="weekly" class="frequency-btn bg-white border border-gray-300 px-4 py-2 rounded-lg font-medium">Hebdomadaire</button>
                                    <button id="monthly" class="frequency-btn bg-white border border-gray-300 px-4 py-2 rounded-lg font-medium">Mensuel</button>
                                </div>
                            </div>
                            
                            <div id="weekly-options" class="hidden">
                                <label class="block text-gray-700 font-medium mb-2">Jours de la semaine</label>
                                <div class="flex flex-wrap gap-2">
                                    <button class="day-btn bg-white border border-gray-300 px-3 py-1 rounded-lg" data-day="1">Lun</button>
                                    <button class="day-btn bg-white border border-gray-300 px-3 py-1 rounded-lg" data-day="2">Mar</button>
                                    <button class="day-btn bg-white border border-gray-300 px-3 py-1 rounded-lg" data-day="3">Mer</button>
                                    <button class="day-btn bg-white border border-gray-300 px-3 py-1 rounded-lg" data-day="4">Jeu</button>
                                    <button class="day-btn bg-white border border-gray-300 px-3 py-1 rounded-lg" data-day="5">Ven</button>
                                    <button class="day-btn bg-white border border-gray-300 px-3 py-1 rounded-lg" data-day="6">Sam</button>
                                    <button class="day-btn bg-white border border-gray-300 px-3 py-1 rounded-lg" data-day="0">Dim</button>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <div>
                        <h2 class="text-2xl font-semibold text-gray-800 mb-6">Résultat CRON</h2>
                        
                        <div class="bg-gray-50 p-6 rounded-lg border border-gray-200 result-box">
                            <div class="flex items-center justify-between mb-4">
                                <h3 class="text-lg font-medium text-gray-700">Expression CRON</h3>
                                <div class="flex gap-2">
                                    <button id="copy-btn" class="copy-btn bg-indigo-600 text-white px-3 py-1 rounded-lg flex items-center gap-1">
                                        <i class="fas fa-copy"></i>
                                        <span>Copier</span>
                                    </button>
                                    <div class="tooltip">
                                        <button class="copy-btn bg-gray-200 text-gray-800 px-3 py-1 rounded-lg">
                                            <i class="fas fa-info-circle"></i>
                                        </button>
                                        <span class="tooltip-text">Format: secondes minutes heures jour mois jour-semaine</span>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="bg-white p-4 rounded-lg border border-gray-200 mb-4">
                                <code id="cron-expression" class="text-lg font-mono text-indigo-600 break-all">* * * * * *</code>
                            </div>
                            
                            <div class="bg-blue-50 p-4 rounded-lg border border-blue-200">
                                <h4 class="font-medium text-blue-800 mb-2 flex items-center gap-2">
                                    <i class="fas fa-info-circle"></i>
                                    <span>Explication</span>
                                </h4>
                                <p id="cron-explanation" class="text-sm text-gray-700">L'expression CRON s'exécutera une fois immédiatement.</p>
                            </div>
                        </div>
                        
                        <div class="mt-6 bg-gray-50 p-4 rounded-lg border border-gray-200">
                            <h3 class="font-medium text-gray-700 mb-2 flex items-center gap-2">
                                <i class="fas fa-question-circle"></i>
                                <span>Comment ça marche ?</span>
                            </h3>
                            <p class="text-sm text-gray-600">Sélectionnez une date et une heure (avec secondes), puis choisissez la fréquence. L'expression CRON correspondante (6 champs) sera générée automatiquement.</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div class="max-w-4xl mx-auto px-4 py-8">
        <div class="bg-white rounded-xl shadow-lg overflow-hidden">
            <div class="p-6 md:p-8">
                <h2 class="text-2xl font-semibold text-gray-800 mb-4">Guide CRON (6 champs)</h2>
                
                <div class="overflow-x-auto">
                    <table class="min-w-full bg-white border border-gray-200">
                        <thead class="bg-gray-50">
                            <tr>
                                <th class="px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Champ</th>
                                <th class="px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Valeurs</th>
                                <th class="px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Description</th>
                            </tr>
                        </thead>
                        <tbody class="divide-y divide-gray-200">
                            <tr>
                                <td class="px-4 py-2 whitespace-nowrap text-sm font-medium text-gray-900">Secondes</td>
                                <td class="px-4 py-2 whitespace-nowrap text-sm text-gray-500">0-59</td>
                                <td class="px-4 py-2 text-sm text-gray-500">Secondes à laquelle la commande s'exécute</td>
                            </tr>
                            <tr>
                                <td class="px-4 py-2 whitespace-nowrap text-sm font-medium text-gray-900">Minutes</td>
                                <td class="px-4 py-2 whitespace-nowrap text-sm text-gray-500">0-59</td>
                                <td class="px-4 py-2 text-sm text-gray-500">Minute à laquelle la commande s'exécute</td>
                            </tr>
                            <tr>
                                <td class="px-4 py-2 whitespace-nowrap text-sm font-medium text-gray-900">Heures</td>
                                <td class="px-4 py-2 whitespace-nowrap text-sm text-gray-500">0-23</td>
                                <td class="px-4 py-2 text-sm text-gray-500">Heure à laquelle la commande s'exécute</td>
                            </tr>
                            <tr>
                                <td class="px-4 py-2 whitespace-nowrap text-sm font-medium text-gray-900">Jour du mois</td>
                                <td class="px-4 py-2 whitespace-nowrap text-sm text-gray-500">1-31</td>
                                <td class="px-4 py-2 text-sm text-gray-500">Jour du mois où la commande s'exécute</td>
                            </tr>
                            <tr>
                                <td class="px-4 py-2 whitespace-nowrap text-sm font-medium text-gray-900">Mois</td>
                                <td class="px-4 py-2 whitespace-nowrap text-sm text-gray-500">1-12</td>
                                <td class="px-4 py-2 text-sm text-gray-500">Mois où la commande s'exécute</td>
                            </tr>
                            <tr>
                                <td class="px-4 py-2 whitespace-nowrap text-sm font-medium text-gray-900">Jour de la semaine</td>
                                <td class="px-4 py-2 whitespace-nowrap text-sm text-gray-500">0-7 (0 et 7 = dimanche)</td>
                                <td class="px-4 py-2 text-sm text-gray-500">Jour de la semaine où la commande s'exécute</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>

    <footer class="bg-gray-800 text-white py-6">
        <div class="max-w-4xl mx-auto px-4 text-center">
            <p>© 2023 Convertisseur CRON avancé. Tous droits réservés.</p>
        </div>
    </footer>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            // Éléments du DOM
            const dateInput = document.getElementById('date');
            const hoursInput = document.getElementById('hours');
            const minutesInput = document.getElementById('minutes');
            const secondsInput = document.getElementById('seconds');
            const frequencyBtns = document.querySelectorAll('.frequency-btn');
            const dayBtns = document.querySelectorAll('.day-btn');
            const weeklyOptions = document.getElementById('weekly-options');
            const cronExpression = document.getElementById('cron-expression');
            const cronExplanation = document.getElementById('cron-explanation');
            const copyBtn = document.getElementById('copy-btn');
            const resetBtn = document.getElementById('reset-btn');
            const nowBtn = document.getElementById('now-btn');
            
            // Définir la date et heure actuelle par défaut
            setCurrentDateTime();
            
            // Variables d'état
            let frequency = 'once';
            let selectedDays = [];
            
            // Écouteurs d'événements
            dateInput.addEventListener('change', updateCron);
            hoursInput.addEventListener('change', validateTimeInput);
            minutesInput.addEventListener('change', validateTimeInput);
            secondsInput.addEventListener('change', validateTimeInput);
            hoursInput.addEventListener('input', updateCron);
            minutesInput.addEventListener('input', updateCron);
            secondsInput.addEventListener('input', updateCron);
            
            frequencyBtns.forEach(btn => {
                btn.addEventListener('click', function() {
                    // Mettre à jour le style des boutons
                    frequencyBtns.forEach(b => {
                        b.classList.remove('bg-indigo-600', 'text-white');
                        b.classList.add('bg-white', 'border', 'border-gray-300');
                    });
                    
                    this.classList.remove('bg-white', 'border', 'border-gray-300');
                    this.classList.add('bg-indigo-600', 'text-white');
                    
                    // Mettre à jour la fréquence
                    frequency = this.id;
                    
                    // Afficher/masquer les options hebdomadaires
                    if (frequency === 'weekly') {
                        weeklyOptions.classList.remove('hidden');
                    } else {
                        weeklyOptions.classList.add('hidden');
                    }
                    
                    updateCron();
                });
            });
            
            dayBtns.forEach(btn => {
                btn.addEventListener('click', function() {
                    const day = this.dataset.day;
                    
                    if (this.classList.contains('bg-indigo-600')) {
                        // Désélectionner
                        this.classList.remove('bg-indigo-600', 'text-white');
                        this.classList.add('bg-white', 'border', 'border-gray-300');
                        selectedDays = selectedDays.filter(d => d !== day);
                    } else {
                        // Sélectionner
                        this.classList.remove('bg-white', 'border', 'border-gray-300');
                        this.classList.add('bg-indigo-600', 'text-white');
                        selectedDays.push(day);
                    }
                    
                    updateCron();
                });
            });
            
            copyBtn.addEventListener('click', function() {
                const text = cronExpression.textContent;
                navigator.clipboard.writeText(text).then(() => {
                    // Afficher un feedback visuel
                    const originalText = copyBtn.innerHTML;
                    copyBtn.innerHTML = '<i class="fas fa-check"></i><span>Copié !</span>';
                    
                    setTimeout(() => {
                        copyBtn.innerHTML = originalText;
                    }, 2000);
                });
            });
            
            resetBtn.addEventListener('click', function() {
                setCurrentDateTime();
                frequencyBtns.forEach(b => {
                    b.classList.remove('bg-indigo-600', 'text-white');
                    b.classList.add('bg-white', 'border', 'border-gray-300');
                });
                document.getElementById('once').classList.remove('bg-white', 'border', 'border-gray-300');
                document.getElementById('once').classList.add('bg-indigo-600', 'text-white');
                frequency = 'once';
                weeklyOptions.classList.add('hidden');
                selectedDays = [];
                dayBtns.forEach(btn => {
                    btn.classList.remove('bg-indigo-600', 'text-white');
                    btn.classList.add('bg-white', 'border', 'border-gray-300');
                });
                updateCron();
            });
            
            nowBtn.addEventListener('click', function() {
                setCurrentDateTime();
                updateCron();
            });
            
            // Fonction pour définir la date et heure actuelle
            function setCurrentDateTime() {
                const now = new Date();
                dateInput.valueAsDate = now;
                hoursInput.value = now.getHours();
                minutesInput.value = now.getMinutes();
                secondsInput.value = now.getSeconds();
            }
            
            // Fonction pour valider les entrées de temps
            function validateTimeInput(e) {
                const input = e.target;
                let value = parseInt(input.value);
                
                if (isNaN(value)) {
                    input.value = 0;
                    return;
                }
                
                const max = input.id === 'hours' ? 23 : 59;
                const min = 0;
                
                if (value > max) input.value = max;
                if (value < min) input.value = min;
                
                updateCron();
            }
            
            // Fonction pour mettre à jour l'expression CRON
            function updateCron() {
                const date = new Date(dateInput.value);
                const hours = parseInt(hoursInput.value) || 0;
                const minutes = parseInt(minutesInput.value) || 0;
                const seconds = parseInt(secondsInput.value) || 0;
                
                date.setHours(hours);
                date.setMinutes(minutes);
                date.setSeconds(seconds);
                
                let cron = '';
                let explanation = '';
                
                switch (frequency) {
                    case 'once':
                        cron = `${seconds} ${minutes} ${hours} ${date.getDate()} ${date.getMonth() + 1} *`;
                        explanation = `L'expression CRON s'exécutera une seule fois le ${formatDate(date)} à ${formatTime(date)}.`;
                        break;
                        
                    case 'daily':
                        cron = `${seconds} ${minutes} ${hours} * * *`;
                        explanation = `L'expression CRON s'exécutera quotidiennement à ${formatTime(date)}.`;
                        break;
                        
                    case 'weekly':
                        if (selectedDays.length === 0) {
                            cron = `${seconds} ${minutes} ${hours} * * ${date.getDay()}`;
                            explanation = `L'expression CRON s'exécutera chaque semaine le ${getDayName(date.getDay())} à ${formatTime(date)}.`;
                        } else {
                            cron = `${seconds} ${minutes} ${hours} * * ${selectedDays.join(',')}`;
                            const dayNames = selectedDays.map(day => getDayName(parseInt(day))).join(', ');
                            explanation = `L'expression CRON s'exécutera chaque semaine les ${dayNames} à ${formatTime(date)}.`;
                        }
                        break;
                        
                    case 'monthly':
                        cron = `${seconds} ${minutes} ${hours} ${date.getDate()} * *`;
                        explanation = `L'expression CRON s'exécutera chaque mois le ${date.getDate()} à ${formatTime(date)}.`;
                        break;
                }
                
                cronExpression.textContent = cron;
                cronExplanation.textContent = explanation;
            }
            
            // Fonctions utilitaires
            function formatDate(date) {
                return date.toLocaleDateString('fr-FR', { 
                    weekday: 'long', 
                    day: 'numeric', 
                    month: 'long', 
                    year: 'numeric' 
                });
            }
            
            function formatTime(date) {
                return date.toLocaleTimeString('fr-FR', { 
                    hour: '2-digit', 
                    minute: '2-digit',
                    second: '2-digit'
                });
            }
            
            function getDayName(day) {
                const days = ['Dimanche', 'Lundi', 'Mardi', 'Mercredi', 'Jeudi', 'Vendredi', 'Samedi'];
                return days[day];
            }
            
            // Initialiser
            document.getElementById('once').click();
            updateCron();
        });
    </script>
</body>
</html>